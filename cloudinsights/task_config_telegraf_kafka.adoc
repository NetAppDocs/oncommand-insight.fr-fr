---
sidebar: sidebar 
permalink: task_config_telegraf_kafka.html 
keywords: telegraf, installation, install, kafka 
summary: Configuration du collecteur de données Kafka 
---
= Collecteur de données Kafka
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights utilise ce collecteur de données pour collecter les mesures à partir de Kafka.



== Installation

. Dans *observabilité > Collectors*, cliquez sur *+Data Collector*. Choisissez Kafka.
+
Sélectionnez le système d'exploitation ou la plate-forme sur laquelle l'agent Telegraf est installé.

. Si vous n'avez pas déjà installé un agent pour la collecte ou si vous souhaitez installer un agent pour un autre système d'exploitation ou plate-forme, cliquez sur _Afficher les instructions_ pour développer le link:task_config_telegraf_agent.html["Installation de l'agent"] instructions.
. Sélectionnez la clé d'accès de l'agent à utiliser avec ce collecteur de données. Vous pouvez ajouter une nouvelle clé d'accès à l'agent en cliquant sur le bouton * + clé d'accès à l'agent*. Meilleure pratique : utilisez une clé d'accès d'agent différente uniquement lorsque vous souhaitez regrouper des collecteurs de données, par exemple, par OS/plate-forme.
. Suivez les étapes de configuration pour configurer le collecteur de données. Les instructions varient en fonction du type de système d'exploitation ou de plate-forme utilisé pour collecter des données.


image:KafkaDCConfigWindows.png["Configuration Kafka"]



== Configuration

Le plug-in Kafka est basé sur le plug-in Jolokia de telegraf. Par exemple, pour recueillir des informations auprès de tous les courtiers Kafka, JMX doit être configuré et exposé via Jolokia sur tous les composants.



=== Compatibilité

La configuration a été développée par rapport à Kafka version 0.11.0.2.



=== Configuration

Toutes les instructions ci-dessous supposent que votre emplacement d'installation pour kafka est '/opt/kafka'. Vous pouvez adapter les instructions ci-dessous en fonction de votre emplacement d'installation.



==== Bol d'agent Jolokia

Une version le fichier JAR de l'agent Jolokia doit être link:https://jolokia.org/download.html["téléchargé"]. La version testée était l'agent Jolokia 1.6.0.

Les instructions ci-dessous supposent que le fichier jar téléchargé (jolokia-jvm-1.6.0-agent.jar) est placé sous l'emplacement '/opt/kafka/libs/'.



==== Kafka Brokers

Pour configurer Kafka Brokers afin d'exposer l'API Jolokia, vous pouvez ajouter ce qui suit dans <KAFKA_HOME>/bin/kafka-Server-start.sh, juste avant l'appel kafka-run-class.sh :

[listing]
----
export JMX_PORT=9999
export RMI_HOSTNAME=`hostname -I`
export KAFKA_JMX_OPTS="-javaagent:/opt/kafka/libs/jolokia-jvm-1.6.0-agent.jar=port=8778,host=0.0.0.0  -Dcom.sun.management.jmxremote.password.file=/opt/kafka/config/jmxremote.password -Dcom.sun.management.jmxremote.ssl=false -Djava.rmi.server.hostname=$RMI_HOSTNAME -Dcom.sun.management.jmxremote.rmi.port=$JMX_PORT"
----
Notez que l'exemple ci-dessus utilise 'hostname -i' pour configurer la variable d'environnement 'RMI_HOSTNAME'. Dans plusieurs machines IP, vous devez modifier cette configuration pour recueillir l'IP sur laquelle vous vous prenez en charge pour les connexions RMI.

Vous pouvez choisir un autre port pour JMX (9999 ci-dessus) et Jolokia (8778). Si vous avez un IP interne pour verrouiller Jolokia sur vous pouvez remplacer le 0.0.0.0 "tout capturer" par votre propre IP. Notez que cette adresse IP doit être accessible à partir du plug-in telegraf. Vous pouvez utiliser l'option -Dcom.sun.management.jmxremote.authenticate=false' si vous ne souhaitez pas vous authentifier. Utilisation à vos propres risques.



== Objets et compteurs

Les objets suivants et leurs compteurs sont collectés :

[cols="<.<,<.<,<.<,<.<"]
|===
| Objet : | Identifiants : | Attributs : | Points de données : 


| Courtier Kafka | Cluster
Espace de noms
Courtier | Nom du nœud
IP du nœud | Délai max. De récupération du gestionnaire de répliques
Connexions client Zookeeper
Zookeeper client Connections (taux de 15 m)
Zookeeper client Connections (débit de 5 m)
Zookeeper client Connections (taux moyen)
Zookeeper client Connections (taux de 1 m)
Nombre de partitions du gestionnaire de répliques
Démon de nombre de threads
Pic de nombre de threads
Nombre de threads actuel
Nombre total de threads démarrés
Partitions hors ligne
Temps total des demandes de production (50e percentile)
Temps total des demandes de production (75e percentile)
Temps total des demandes de production (95ème percentile)
Temps total des demandes de production (98 centile)
Temps total des demandes de production (999e percentile)
Temps total des demandes de production (99e percentile)
Temps total des demandes de production
Temps total max. Des demandes de production
Produire les demandes moyenne de temps total
Temps total min. Des demandes de production
Production des demandes temps total de la période de travail
L'ISR du gestionnaire de réplica diminue
Réduction du ISR du gestionnaire de réplication (taux de 15 m)
Réduction du ISR du gestionnaire de réplication (fréquence de 5 m)
Réduction du taux ISR (taux moyen) par Replica Manager
Réduction de l'ISR du gestionnaire de réplication (taux de 1 m)
Ralenti moyen du gestionnaire de demandes
Ralenti moyen du gestionnaire de demandes (fréquence de 15 m)
Ralenti moyen du gestionnaire de demandes (débit de 5 m)
Ralenti moyen du gestionnaire de demandes (taux moyen)
Ralenti moyen du gestionnaire de demandes (fréquence de 1 m)
Garbage Collection G1 compte ancienne génération
Garbage Collection G1 ancien temps de génération
Garbage Collection G1 Young Generation Count
Garbage Collection G1 Young Generation Time
Zookeeper en lecture seule se connecte
Zookeeper en lecture seule se connecte (fréquence de 15 m)
Zookeeper en lecture seule se connecte (débit de 5 m)
Connexions Zookeeper en lecture seule (taux moyen)
Zookeeper en lecture seule se connecte (taux de 1 m)
Moyenne du processeur réseau en veille
Demande de temps total de fetch Follower (50e percentile)
Temps total de l'outil de recherche de demandes (75e percentile)
Temps total des requêtes Fetch Follower (95e percentile)
Demandes Fetch Follower temps total (98e percentile)
Demande de temps total de fetch Follower (999e percentile)
Temps total de l'outil de recherche de demandes (99e percentile)
Demande de temps total de récupération du suiveur
Demande Fetch Follower temps total max
Demande Fetch Follower temps total moyen
Demande Fetch Follower temps total min
Demande de temps total de chargement de l'outil de récupération de l'outil de recherche
Demandes en attente dans le purgatoire de produits
Le réseau demande l'utilisateur de récupération
Demandes réseau Fetch Consumer (débit de 5 m)
Demandes réseau Fetch Consumer (débit de 15 m)
Demandes réseau Fetch Consumer (taux moyen)
Demandes réseau Fetch Consumer (taux de 1 m)
Élections de leader impropres
Élections de leader impropres (taux de 15 m)
Élections de leader impropres (taux de 5 m)
Élections de leader impropres (taux moyen)
Élections de leader impropres (taux de 1 m)
Contrôleurs actifs
Mémoire de segment de mémoire validée
Initialisation de la mémoire du tas
Mémoire de tas max
Mémoire de tas utilisée
La session Zookeeper expire
Expiration de la session Zookeeper (taux de 15 m)
Expiration de la session Zookeeper (fréquence de 5 m)
Expiration de la session Zookeeper (taux moyen)
Expiration de la session Zookeeper (taux de 1 m)
Échec de l'authentification Zookeeper
Échecs d'authentification Zookeeper (taux de 15 m)
Échecs d'authentification Zookeeper (fréquence de 5 m)
Échecs d'authentification Zookeeper (taux moyen)
Échecs d'authentification Zookeeper (taux de 1 m)
Heure d'élection du leader (50e percentile)
Heure de l'élection du leader (75e centile)
Heure de l'élection du leader (95e centile)
Heure d'élection du leader (98e centile)
Heure de l'élection du leader (999e centile)
Heure de l'élection du leader (99e centile)
Nombre d'élections du chef
Heure de l'élection du chef (taux de 15 m)
Heure d'élection du leader (5 m)
Délai max. D'élection du chef
Temps moyen d'élection du chef
Heure de l'élection du chef (taux moyen)
Délai d'élection du chef min
Heure d'élection du leader (taux de 1 m)
Heure d'élection du chef (stddev)
Requêtes réseau fetch Foller
Requêtes réseau Fetch Follower (vitesse de 15 m)
Requêtes réseau Fetch Follower (débit de 5 m)
Requêtes réseau Fetch Follower (débit moyen)
Requêtes réseau Fetch Follower (débit de 1 m)
Messages du courtier
Messages du courtier (taux de 15 m)
Messages du courtier (taux de 5 m)
Messages du courtier (taux moyen)
Messages sur le sujet du courtier (taux de 1 m)
Octets de la rubrique du courtier dans
Octets de la rubrique du courtier en (taux de 15 m)
Octets de la rubrique du courtier en (débit de 5 m)
Octets de la rubrique du courtier en (taux moyen)
Octets du sujet du courtier en (taux de 1 m)
Le Zookeeper déconnecte le nombre
Déconnexion Zookeeper (fréquence de 15 m)
Déconnexion Zookeeper (débit de 5 m)
Déconnexion Zookeeper (taux moyen)
Déconnexion Zookeeper (fréquence de 1 m)
Demandes réseau temps total de récupération des consommateurs (50e percentile)
Demandes réseau temps total de récupération client (75e percentile)
Demandes réseau - temps total du consommateur (95e centile)
Demandes réseau temps total du consommateur (98e centile)
Demandes réseau temps total de récupération client (999e centile)
Demandes réseau – temps total du consommateur de récupération (99e centile)
Demandes réseau récupération du temps total du consommateur
Demandes réseau récupération client temps total max
Demandes réseau récupération client temps total moyen
Demandes réseau récupération client temps total min
Requêtes réseau récupération client temps total stddev
Nombre de dérivations
Demandes en attente dans Fetch Purgatory
La rubrique du courtier est en octets
Octets de la rubrique du courtier en sortie (taux de 15 m)
Octets de la rubrique du courtier en sortie (débit de 5 m)
Octets de la rubrique du courtier en sortie (taux moyen)
Octets de la rubrique du courtier (taux de 1 m)
Authentification Zookeeper
Authentification Zookeeper (taux de 15 m)
Authentification Zookeeper (débit de 5 m)
Authentification Zookeeper (taux moyen)
Authentification Zookeeper (taux de 1 m)
Nombre de demandes de production
Demande de produit (taux de 15 m)
Demande de production (débit de 5 m)
Demande de production (taux moyen)
Demande de produit (taux de 1 m)
Replica Manager ISR se développe
Le service ISR de Replica Manager se développe (taux de 15 m)
Le service ISR de Replica Manager augmente (fréquence de 5 m)
Le service ISR de Replica Manager se développe (taux moyen)
Replica Manager ISR augmente (taux de 1 m)
Replica Manager sous partitions répliquées 
|===


== Dépannage

Pour plus d'informations, consultez le link:concept_requesting_support.html["Assistance"] page.
