---
sidebar: sidebar 
permalink: task_config_telegraf_hadoop.html 
keywords: telegraf, installation, install, Hadoop 
summary: Configuration du collecteur de données Hadoop 
---
= Collecteur de données Hadoop
:hardbreaks:
:toclevels: 1
:allow-uri-read: 
:toclevels: 1
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Insights utilise ce collecteur de données pour collecter des metrics à partir de Hadoop.



== Installation

. Dans *observabilité > Collectors*, cliquez sur *+Data Collector*. Avec Hadoop
+
Sélectionnez le système d'exploitation ou la plate-forme sur laquelle l'agent Telegraf est installé.

. Si vous n'avez pas déjà installé un agent pour la collecte ou si vous souhaitez installer un agent pour un autre système d'exploitation ou plate-forme, cliquez sur _Afficher les instructions_ pour développer le link:task_config_telegraf_agent.html["Installation de l'agent"] instructions.
. Sélectionnez la clé d'accès de l'agent à utiliser avec ce collecteur de données. Vous pouvez ajouter une nouvelle clé d'accès à l'agent en cliquant sur le bouton * + clé d'accès à l'agent*. Meilleure pratique : utilisez une clé d'accès d'agent différente uniquement lorsque vous souhaitez regrouper des collecteurs de données, par exemple, par OS/plate-forme.
. Suivez les étapes de configuration pour configurer le collecteur de données. Les instructions varient en fonction du type de système d'exploitation ou de plate-forme utilisé pour collecter des données.


image:HadoopDCConfigLinux-1.png["Configuration Hadoop"]
image:HadoopDCConfigLinux-2.png["Configuration Hadoop"]



== Configuration

Un déploiement Hadoop complet nécessite les composants suivants :

* NameNode : système principal Hadoop Distributed File System (HDFS). Coordonne une série de DataNodes.
* Second NameNode : basculement à chaud pour le NameNode principal. Dans Hadoop, la promotion vers NameNode n'a pas lieu automatiquement. Second NameNode collecte les informations du NameNode pour être prêt à être promu au besoin.
* DataNode : propriétaire réel des données.
* ResourceManager : le système principal de calcul (Yarn). Coordonne une série de gestionnaires de nœud.
* NodeManager : la ressource pour le calcul. Emplacement réel pour l'exécution des applications.
* JobHistoriyServer : responsable du traitement de toutes les requêtes liées à l'historique des travaux.


Le plug-in Hadoop est basé sur le plug-in Jolokia de telegraf. Par exemple, pour collecter des informations à partir de tous les composants Hadoop, JMX doit être configuré et exposé via Jolokia sur tous les composants.



=== Compatibilité

La configuration a été développée à partir de la version Hadoop 2.9.2.



=== Configuration



==== Bol d'agent Jolokia

Pour tous les composants individuels, une version du fichier JAR de l'agent Jolokia doit être téléchargée. La version testée sur était link:https://jolokia.org/download.html["Agent de Jolokia 1.6.0"].

Les instructions ci-dessous supposent que le fichier jar téléchargé (jolokia-jvm-1.6.0-agent.jar) est placé sous l'emplacement '/opt/hadoop/lib/'.



==== Nom de nœud

Pour configurer NameNode afin d'exposer l'API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export HADOOP_NAMENODE_OPTS="$HADOOP_NAMENODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7800,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8000 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8000 above) and Jolokia (7800). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== Nom de nœud secondaire

Pour configurer le NameNode secondaire pour exposer l’API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export HADOOP_SECONDARYNAMENODE_OPTS="$HADOOP_SECONDARYNAMENODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7802,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8002 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8002 above) and Jolokia (7802). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== Nœud de données

Pour configurer les DataNodes pour exposer l’API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export HADOOP_DATANODE_OPTS="$HADOOP_DATANODE_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7801,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8001 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8001 above) and Jolokia (7801). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== ResourceManager

Pour configurer ResourceManager pour exposer l'API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export YARN_RESOURCEMANAGER_OPTS="$YARN_RESOURCEMANAGER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7803,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8003 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8003 above) and Jolokia (7803). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== Gestionnaire de nœud

Pour configurer les gestionnaires de nœud afin d'exposer l'API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export YARN_NODEMANAGER_OPTS="$YARN_NODEMANAGER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7804,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8004 -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8004 above) and Jolokia (7804). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


==== JobHistoriyServer

Pour configurer JobHistoriyServer afin d'exposer l'API Jolokia, vous pouvez configurer les éléments suivants dans <HADOOP_HOME>/etc/hadoop/hadoop-env.sh :

[listing]
----
export HADOOP_JOB_HISTORYSERVER_OPTS="$HADOOP_JOB_HISTORYSERVER_OPTS -javaagent:/opt/hadoop/lib/jolokia-jvm-1.6.0-agent.jar=port=7805,host=0.0.0.0 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=8005 -Dcom.sun.management.jmxremote.password.file=$HADOOP_HOME/conf/jmxremote.password"
You can choose a different port for JMX (8005 above) and Jolokia (7805). If you have an internal IP to lock Jolokia onto you can replace the "catch all" 0.0.0.0 by your own IP. Notice this IP needs to be accessible from the telegraf plugin. You can use the option '-Dcom.sun.management.jmxremote.authenticate=false' if you don't want to authenticate. Use at your own risk.
----


== Objets et compteurs

Les objets suivants et leurs compteurs sont collectés :

[cols="<.<,<.<,<.<,<.<"]
|===
| Objet : | Identifiants : | Attributs : | Points de données : 


| Nom de nœud secondaire Hadoop | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud
Informations de compilation
Version | Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 


| Hadoop NodeManager | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud | Conteneurs alloués
Allocation de mémoire
Mémoire allouée Oportunistic
Cœurs virtuels alloués Oportunistic
Cœurs virtuels alloués
Mémoire disponible
Cœurs virtuels disponibles
Répertoires locaux incorrects
Journaux des répertoires incorrects
Taille du cache avant nettoyage
Durée moyenne de lancement du conteneur
Durée de lancement du conteneur nombre d'opérations
Conteneurs terminés
Échec des conteneurs
Conteneurs en entrée
Conteneurs tués
Conteneurs lancés
Le conteneurs Reinting
Reprise des conteneurs en cas de défaillance
Conteneurs en cours d'exécution
Bons répertoires locaux d'utilisation des disques
Utilisation du disque bons répertoires de journaux
Octets supprimés privés
Octets supprimés public
Les conteneurs s'exécutant comme des opportunistes
Nombre total d'octets supprimés
Connexion aléatoire
Lecture aléatoire des octets de sortie
Echec de la lecture aléatoire des sorties
Sorties de lecture aléatoire OK
Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 


| Gestionnaire de ressources Hadoop | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud | Délai de lancement Moy. ApplicationMaster
Numéro du délai de lancement de ApplicationMaster
Délai moyen du registre ApplicationMaster
Numéro de délai du registre ApplicationMaster
Numéro actif NodeManager
Numéro de désavis de NodeManager
Numéro de désaffectation de NodeManager
Numéro NodeManager perdu
Numéro de redémarrage de NodeManager
Numéro d'arrêt NodeManager
Numéro sain NodeManager
Limite de mémoire NodeManager
Limite des cœurs virtuels NodeManager
Capacité utilisée
Applications actives
Utilisateurs actifs
Agrégats de conteneurs alloués
Anticiper les conteneurs d'agrégats
Conteneurs agrégés libérés
Secondes de mémoire agrégée préemptées
Conteneurs locaux de nœud agrégé alloués
Agrégats hors conteneurs alloués
Conteneurs locaux Ack agrégés alloués
Nombre de cœurs virtuels agrégés secondes préemptées
Conteneurs alloués
Mémoire allouée
Cœurs virtuels alloués
Délai moyen d'attribution du premier conteneur de tentative d'application
Numéro du délai d'attribution du premier conteneur de tentative d'application
Demandes terminées
Les applications ont échoué
Applications tuées
Applications en attente
Applications en cours d'exécution
Demandes soumises
Mémoire disponible
Cœurs virtuels disponibles
Conteneurs en attente
Mémoire en attente
Cœurs virtuels en attente
Conteneurs réservés
Mémoire réservée
Cœurs virtuels réservés
Memory ApplicationMaster utilisé
Noyaux virtuels ApplicationMaster utilisés
Capacité utilisée
Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 


| Nœud de données Hadoop | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud
ID de cluster
Version | Nombre d'émetteurs-récepteurs
Transmission en cours
Capacité du cache
Cache utilisé
Puissance
DFS utilisé
Capacité estimée perdue Total
Taux de défaillance du dernier volume
Nombre de blocs mis en cache
Impossible de mettre en cache le numéro des blocs
Impossible d'annuler la mise en cache du numéro de bloc
Échec du numéro de volumes
Capacité restante
Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 


| Nom de nœud Hadoop | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud
ID de transaction de la dernière écriture
Temps écoulé depuis la dernière modification chargée
État HA
Etat du système de fichiers
ID de pool de blocs
ID de cluster
Informations de compilation
Nombre de versions distinct
Version | Capacité de blocs
Total des blocs
Capacité totale
Capacité utilisée
Capacité utilisée non DFS
Blocs corrompus
Capacité estimée perdue Total
Bloque l'excès
Battements cardiaques expirés
Total des fichiers
Longueur de la file d'attente de verrouillage du système de fichiers
Blocs manquants
Bloque la réplication manquante avec le facteur 1
Clients actifs
Nœuds de données morts
Désaffectation des nœuds de données
Mise hors service des nœuds de données
Décodage des nœuds de données
Nombre de zones de chiffrement
Nœuds de données entrant en maintenance
Dossiers en construction
Les nœuds de données morts lors de la maintenance
Les nœuds de données sont sous maintenance
Nœuds de données Live
Stockage périmé
Délais de réplication en attente
Message de nœud de données en attente
Blocs en attente de suppression
Blocs en attente de réplication
Blocs non répliqués reportés
Bloque la réplication planifiée
Snapshots
Répertoires Snapshottable
Les nœuds de données obsolètes
Total des fichiers
Charge totale
Total du décompte de synchronisation
Transactions depuis le dernier point de contrôle
Transactions depuis la dernière liste des journaux
Blocs sous-répliqués
Défaillances de volume Total
Temps de synchronisation total
Objets Max
Ajout de bloc d'opérations
Les opérations permettent les instantanés
Bloc d'opérations en lot
Bloc d'opérations en file d'attente
Bloc d'opérations reçu et supprimé
Temps moyen du rapport d'opérations
Numéro du rapport de bloc d'opérations
Temps moyen du rapport de cache
Numéro du rapport de cache
Opérations Créer un fichier
Opérations Créer des instantanés
Opérations Créer un lien symbolique
Opérations Supprimer le fichier
Opérations Supprimer l'instantané
Opérations interdire l'instantané
Entrée/sortie du fichier d'opérations
Fichiers ajoutés
Fichiers créés
Fichiers supprimés
Liste des fichiers
Fichiers renommés
Fichiers tronqués
Temps de chargement du système de fichiers
Les opérations génèrent le temps moyen EDEK
Les opérations génèrent EDEK
Opérations obtenir un nœud de données supplémentaire
Bloquer obtenir des emplacements
Obtenir le temps moyen de modification
Obtenir le numéro de modification
Obtenez le temps moyen de l'image
Obtenir le numéro d'image
Opérations obtenir la cible de lien
Opérations obtenir la liste
Operations List Snapshottable dir
Numéro de réplication non planifié
Temps moyen de l'image PUT
Indiquez le numéro de l'image
Opérations Renommer les instantanés
Temps de vérification des ressources temps moyen
Numéro de l'heure de vérification de la ressource
Heure du mode sans échec
Rapport diff. Instantané opérations
Rapport sur les blocs de stockage des opérations
Réplication réussie
Temps moyen de synchronisation
Numéro de synchronisation des opérations
Délai d'expiration de la réplication
Total des opérations
Temps moyen de transaction
Transaction Batchd dans Sync
Numéro de transaction
Temps de chauffe moyen EDEK
Numéro de chauffe EDEK
Espace utilisé dans le pool de blocs
Capacité du cache
Cache utilisé
Capacité libre
Pourcentage d'utilisation du pool de blocs
Pourcentage restant
Pourcentage utilisé
Filetages
Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 


| Hadoop JobHistoriyServer | Cluster
Espace de noms
Serveur | Nom du nœud
IP du nœud | Comptage GC
Nombre de copies GC
Marques GC balayage Compact Count
Seuil d'informations sur le numéro GC dépassé
Seuil d'avertissement de numéro GC dépassé
Temps GC
Heure de copie GC
Marques GC balayage temps compact
Temps de veille supplémentaire total GC
Nombre d'erreurs dans les journaux
Consigne le nombre de décès
Nombre d'informations sur les journaux
Nombre d'avertissements des journaux
Mémoire Heap validée
Mémoire Heap Max
Mémoire Heap utilisée
Mémoire max
Mémoire non Heap validée
Mémoire non Heap Max
Mémoire non Heap utilisée
Threads bloqués
Threads Nouveau
Threads exécutables
Threads terminés
Threads en attente
Threads en attente 
|===


== Dépannage

Pour plus d'informations, consultez le link:concept_requesting_support.html["Assistance"] page.
